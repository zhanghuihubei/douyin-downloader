[1mdiff --git a/background.js b/background.js[m
[1mindex 68de1c8..50dad03 100644[m
[1m--- a/background.js[m
[1m+++ b/background.js[m
[36m@@ -562,6 +562,54 @@[m [mchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {[m
     })();[m
     return true;[m
   }[m
[32m+[m[41m  [m
[32m+[m[32m  if (request.action === 'deleteAllRecords') {[m
[32m+[m[32m    console.log('ğŸ—‘ï¸ æ”¶åˆ°åˆ é™¤å…¨éƒ¨è®°å½•è¯·æ±‚');[m
[32m+[m[41m    [m
[32m+[m[32m    (async () => {[m
[32m+[m[32m      try {[m
[32m+[m[32m        // åœæ­¢æ‰€æœ‰ä¸‹è½½[m
[32m+[m[32m        console.log('ğŸ›‘ åœæ­¢æ‰€æœ‰ä¸‹è½½...');[m
[32m+[m[32m        stopAutoDownload();[m
[32m+[m[32m        downloadQueue = [];[m
[32m+[m[32m        isDownloading = false;[m
[32m+[m[32m        stopDownload = true;[m
[32m+[m[41m        [m
[32m+[m[32m        // ä¸­æ–­æ‰€æœ‰æ­£åœ¨è¿›è¡Œçš„ä¸‹è½½[m
[32m+[m[32m        const tabs = await chrome.tabs.query({ url: 'https://www.douyin.com/*' });[m
[32m+[m[32m        const downloadIds = Array.from(inFlightDownloads.keys());[m
[32m+[m[32m        console.log(`ğŸ†” åˆ é™¤æ—¶éœ€è¦ä¸­æ–­çš„ä¸‹è½½IDåˆ—è¡¨: ${downloadIds.join(', ')}`);[m
[32m+[m
[32m+[m[32m        for (const tab of tabs) {[m
[32m+[m[32m          try {[m
[32m+[m[32m            await chrome.tabs.sendMessage(tab.id, {[m
[32m+[m[32m              action: 'abortDownload',[m
[32m+[m[32m              timestamp: Date.now(),[m
[32m+[m[32m              downloadIds: downloadIds[m
[32m+[m[32m            });[m
[32m+[m[32m          } catch (error) {[m
[32m+[m[32m            console.log(`âš ï¸ é€šçŸ¥æ ‡ç­¾é¡µ ${tab.id} ä¸­æ–­ä¸‹è½½å¤±è´¥:`, error.message);[m
[32m+[m[32m          }[m
[32m+[m[32m        }[m
[32m+[m
[32m+[m[32m        // æ¸…ç†ä¸‹è½½çŠ¶æ€[m
[32m+[m[32m        inFlightDownloads.clear();[m
[32m+[m[32m        stoppedDownloadIds.clear();[m
[32m+[m[41m        [m
[32m+[m[32m        // åˆ é™¤æ‰€æœ‰æ•°æ®åº“è®°å½•[m
[32m+[m[32m        console.log('ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®åº“...');[m
[32m+[m[32m        await DouyinDB.clearAllData();[m
[32m+[m[41m        [m
[32m+[m[32m        console.log('âœ… æ‰€æœ‰è®°å½•å·²åˆ é™¤');[m
[32m+[m[32m        sendResponse({ success: true });[m
[32m+[m[32m      } catch (error) {[m
[32m+[m[32m        console.error('âŒ åˆ é™¤å…¨éƒ¨è®°å½•å¤±è´¥:', error);[m
[32m+[m[32m        sendResponse({ success: false, error: error.message });[m
[32m+[m[32m      }[m
[32m+[m[32m    })();[m
[32m+[m[41m    [m
[32m+[m[32m    return true;[m
[32m+[m[32m  }[m
 });[m
 [m
 // æ·»åŠ è§†é¢‘åˆ°ä¸‹è½½é˜Ÿåˆ—[m
[1mdiff --git a/db.js b/db.js[m
[1mindex 20aa300..6441221 100644[m
[1m--- a/db.js[m
[1m+++ b/db.js[m
[36m@@ -587,6 +587,99 @@[m [masync function deleteVideo(awemeId) {[m
   });[m
 }[m
 [m
[32m+[m[32m/**[m
[32m+[m[32m * æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“è®°å½•[m
[32m+[m[32m */[m
[32m+[m[32masync function clearAllData() {[m
[32m+[m[32m  const database = await getDB();[m
[32m+[m[32m  return new Promise((resolve, reject) => {[m
[32m+[m[32m    const transaction = database.transaction(['users', 'videos', 'config'], 'readwrite');[m
[32m+[m[41m    [m
[32m+[m[32m    let completed = 0;[m
[32m+[m[32m    const totalStores = 3;[m
[32m+[m[32m    let hasError = false;[m
[32m+[m[41m    [m
[32m+[m[32m    const checkComplete = () => {[m
[32m+[m[32m      completed++;[m
[32m+[m[32m      if (completed === totalStores) {[m
[32m+[m[32m        if (hasError) {[m
[32m+[m[32m          reject(new Error('éƒ¨åˆ†æ•°æ®æ¸…é™¤å¤±è´¥'));[m
[32m+[m[32m        } else {[m
[32m+[m[32m          console.log('âœ… æ‰€æœ‰æ•°æ®åº“è®°å½•å·²æ¸…ç©º');[m
[32m+[m[32m          resolve(true);[m
[32m+[m[32m        }[m
[32m+[m[32m      }[m
[32m+[m[32m    };[m
[32m+[m[41m    [m
[32m+[m[32m    // æ¸…ç©ºç”¨æˆ·è¡¨[m
[32m+[m[32m    const usersStore = transaction.objectStore('users');[m
[32m+[m[32m    const usersRequest = usersStore.clear();[m
[32m+[m[32m    usersRequest.onsuccess = () => {[m
[32m+[m[32m      console.log('âœ… ç”¨æˆ·è¡¨å·²æ¸…ç©º');[m
[32m+[m[32m      checkComplete();[m
[32m+[m[32m    };[m
[32m+[m[32m    usersRequest.onerror = (event) => {[m
[32m+[m[32m      console.error('âŒ æ¸…ç©ºç”¨æˆ·è¡¨å¤±è´¥:', event.target.error);[m
[32m+[m[32m      hasError = true;[m
[32m+[m[32m      checkComplete();[m
[32m+[m[32m    };[m
[32m+[m[41m    [m
[32m+[m[32m    // æ¸…ç©ºè§†é¢‘è¡¨[m
[32m+[m[32m    const videosStore = transaction.objectStore('videos');[m
[32m+[m[32m    const videosRequest = videosStore.clear();[m
[32m+[m[32m    videosRequest.onsuccess = () => {[m
[32m+[m[32m      console.log('âœ… è§†é¢‘è¡¨å·²æ¸…ç©º');[m
[32m+[m[32m      checkComplete();[m
[32m+[m[32m    };[m
[32m+[m[32m    videosRequest.onerror = (event) => {[m
[32m+[m[32m      console.error('âŒ æ¸…ç©ºè§†é¢‘è¡¨å¤±è´¥:', event.target.error);[m
[32m+[m[32m      hasError = true;[m
[32m+[m[32m      checkComplete();[m
[32m+[m[32m    };[m
[32m+[m[41m    [m
[32m+[m[32m    // æ¸…ç©ºé…ç½®è¡¨ï¼ˆä¿ç•™åŸºæœ¬é…ç½®ï¼‰[m
[32m+[m[32m    const configStore = transaction.objectStore('config');[m
[32m+[m[32m    const configRequest = configStore.clear();[m
[32m+[m[32m    configRequest.onsuccess = () => {[m
[32m+[m[32m      console.log('âœ… é…ç½®è¡¨å·²æ¸…ç©º');[m
[32m+[m[32m      // é‡æ–°ä¿å­˜åŸºæœ¬é…ç½®[m
[32m+[m[32m      const saveTransaction = database.transaction(['config'], 'readwrite');[m
[32m+[m[32m      const saveStore = saveTransaction.objectStore('config');[m
[32m+[m[41m      [m
[32m+[m[32m      const defaultConfigs = [[m
[32m+[m[32m        { key: 'autoDownload', value: true },[m
[32m+[m[32m        { key: 'checkInterval', value: 3600000 },[m
[32m+[m[32m        { key: 'lastCheckTime', value: null },[m
[32m+[m[32m        { key: 'minDelay', value: 20000 },[m
[32m+[m[32m        { key: 'maxDelay', value: 30000 },[m
[32m+[m[32m        { key: 'migrated', value: true }[m
[32m+[m[32m      ];[m
[32m+[m[41m      [m
[32m+[m[32m      let saved = 0;[m
[32m+[m[32m      defaultConfigs.forEach(config => {[m
[32m+[m[32m        const saveRequest = saveStore.put(config);[m
[32m+[m[32m        saveRequest.onsuccess = () => {[m
[32m+[m[32m          saved++;[m
[32m+[m[32m          if (saved === defaultConfigs.length) {[m
[32m+[m[32m            console.log('âœ… é»˜è®¤é…ç½®å·²æ¢å¤');[m
[32m+[m[32m            checkComplete();[m
[32m+[m[32m          }[m
[32m+[m[32m        };[m
[32m+[m[32m        saveRequest.onerror = (event) => {[m
[32m+[m[32m          console.error('âŒ ä¿å­˜é»˜è®¤é…ç½®å¤±è´¥:', event.target.error);[m
[32m+[m[32m          hasError = true;[m
[32m+[m[32m          checkComplete();[m
[32m+[m[32m        };[m
[32m+[m[32m      });[m
[32m+[m[32m    };[m
[32m+[m[32m    configRequest.onerror = (event) => {[m
[32m+[m[32m      console.error('âŒ æ¸…ç©ºé…ç½®è¡¨å¤±è´¥:', event.target.error);[m
[32m+[m[32m      hasError = true;[m
[32m+[m[32m      checkComplete();[m
[32m+[m[32m    };[m
[32m+[m[32m  });[m
[32m+[m[32m}[m
[32m+[m
 /**[m
  * è·å–ç»Ÿè®¡ä¿¡æ¯[m
  */[m
[36m@@ -846,6 +939,7 @@[m [mconst DouyinDB = {[m
   markVideoAsDownloaded,[m
   deleteVideo,[m
   deleteVideosByUser,[m
[32m+[m[32m  clearAllData,[m
   [m
   // ç»Ÿè®¡[m
   getStats,[m
[1mdiff --git a/manage.js b/manage.js[m
[1mindex 364057c..66ce491 100644[m
[1m--- a/manage.js[m
[1m+++ b/manage.js[m
[36m@@ -714,3 +714,106 @@[m [mfunction updateUserVideoCounts() {[m
     }[m
   });[m
 }[m
[32m+[m
[32m+[m[32m// åˆ é™¤å…¨éƒ¨è®°å½•å¤„ç†å‡½æ•°[m
[32m+[m[32masync function handleDeleteAll() {[m
[32m+[m[32m  console.log('ğŸ—‘ï¸ è¯·æ±‚åˆ é™¤å…¨éƒ¨è®°å½•...');[m
[32m+[m[41m  [m
[32m+[m[32m  // ç”Ÿæˆéšæœº4ä½æ•°éªŒè¯ç [m
[32m+[m[32m  const verificationCode = Math.floor(1000 + Math.random() * 9000).toString();[m
[32m+[m[41m  [m